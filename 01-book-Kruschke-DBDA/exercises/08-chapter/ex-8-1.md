# Ex. 8.1
Andrey Ziyatdinov  
`r Sys.Date()`  



### Parameters


```r
dir <- "~/git/variani/study/01-book-Kruschke-DBDA/doc/programs/DBDA2Eprograms"
```

## Include DBDA2 files


```r
library(coda)
```

## Example `Jags-Ydich-Xnom1subj-MbernBeta-Example.R`

See code in the `Jags-Ydich-Xnom1subj-MbernBeta-Example.R` file.

### Source files



Sourced files: `Jags-Ydich-Xnom1subj-MbernBeta.R`.

### Parameters


```r
fn <- "Jags-Ydich-Xnom1subj-MbernBeta-" 

nsteps <- 10000
```

### Read data


```r
dat <- read.csv(file.path(dir, "z15N50.csv"))
str(dat)
```

```
'data.frame':	50 obs. of  1 variable:
 $ y: int  0 1 0 0 0 0 0 0 0 0 ...
```


```r
table(dat$y)
```

```

 0  1 
35 15 
```

### MCMC samples


```r
myData <- dat
out <- genMCMC(data = myData, numSavedSteps = nsteps, saveName = fn)
```


```r
summary(out)
```

```

Iterations = 501:3000
Thinning interval = 1 
Number of chains = 4 
Sample size per chain = 2500 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

          Mean             SD       Naive SE Time-series SE 
     0.3076041      0.0636568      0.0006366      0.0006321 

2. Quantiles for each variable:

  2.5%    25%    50%    75%  97.5% 
0.1892 0.2633 0.3054 0.3491 0.4388 
```

### Plot diagnostics


```r
diagMCMC(out)
```

![](figures-8-1/diagMCMC-1.png) 

### Plot posteriors


```r
plotMCMC(out, data = myData)
```

![](figures-8-1/post-1.png) 

## Example `Jags-Ydich-XnomSsubj-MbernBeta-Example.R`

See code in the `Jags-Ydich-XnomSsubj-MbernBeta-Example.R` file.

### Source files



Sourced files: `Jags-Ydich-XnomSsubj-MbernBeta.R`.

### Parameters


```r
fn <- "Jags-Ydich-XnomSsubj-MbernBeta-"

nsteps <- 50000
```

### Read data


```r
dat <- read.csv(file.path(dir, "z6N8z2N7.csv"))
str(dat)
```

```
'data.frame':	15 obs. of  2 variables:
 $ y: int  1 0 1 1 1 1 1 0 0 0 ...
 $ s: Factor w/ 2 levels "Reginald","Tony": 1 1 1 1 1 1 1 1 2 2 ...
```

### MCMC samples


```r
myData <- dat
out <- genMCMC(data = myData, numSavedSteps = nsteps, saveName = fn)
```


```r
summary(out)
```

```

Iterations = 501:13000
Thinning interval = 1 
Number of chains = 4 
Sample size per chain = 12500 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

           Mean     SD  Naive SE Time-series SE
theta[1] 0.6668 0.1303 0.0005827      0.0005851
theta[2] 0.3637 0.1390 0.0006217      0.0006209

2. Quantiles for each variable:

           2.5%    25%    50%    75%  97.5%
theta[1] 0.3922 0.5803 0.6763 0.7626 0.8899
theta[2] 0.1231 0.2599 0.3553 0.4593 0.6531
```

### Plot diagnostics


```r
l_ply(varnames(out), function(p) {
  diagMCMC(out, p)
})
```

![](figures-8-1/diagMCMC2-1.png) ![](figures-8-1/diagMCMC2-2.png) 

### Plot posteriors


```r
plotMCMC(out, data = myData, compVal = NULL , compValDiff = 0.0, ropeDiff = c(-0.05, 0.05))
```

![](figures-8-1/post2-1.png) 

## Exercise 8.1: two subjets with different sample size

### Read data


```r
dat <- read.csv(file.path(dir, "z6N8z2N7.csv"))

# remove some samples from `dat` for the Subject #2
dat <- rbind(dat[1:8, ], dat[1:8, ], dat[1:8, ], dat[1:8, ], dat[1:8, ],
  dat[9:15, ])

str(dat)
```

```
'data.frame':	47 obs. of  2 variables:
 $ y: int  1 0 1 1 1 1 1 0 1 0 ...
 $ s: Factor w/ 2 levels "Reginald","Tony": 1 1 1 1 1 1 1 1 1 1 ...
```

```r
table(dat$s)
```

```

Reginald     Tony 
      40        7 
```

### MCMC samples


```r
myData <- dat 
out <- genMCMC(data = myData, numSavedSteps = nsteps, saveName = fn)
```


```r
summary(out) 
```

```

Iterations = 501:13000
Thinning interval = 1 
Number of chains = 4 
Sample size per chain = 12500 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

           Mean      SD  Naive SE Time-series SE
theta[1] 0.7277 0.06616 0.0002959      0.0002988
theta[2] 0.3641 0.13915 0.0006223      0.0006147

2. Quantiles for each variable:

           2.5%    25%    50%    75%  97.5%
theta[1] 0.5889 0.6848 0.7310 0.7746 0.8461
theta[2] 0.1225 0.2605 0.3557 0.4587 0.6524
```

### Plot diagnostics


```r
l_ply(varnames(out), function(p) {
  diagMCMC(out, p) 
})
```

![](figures-8-1/diagMCMC3-1.png) ![](figures-8-1/diagMCMC3-2.png) 

### Plot posteriors


```r
plotMCMC(out, data = myData, compVal = NULL , compValDiff = 0.0, ropeDiff = c(-0.05, 0.05)) 
```

![](figures-8-1/post3-1.png) 

### Conclusions

More samples for the Subject #1 improves estimation of the theta 1 parameter,
as well as estimation of the difference between thetas 1 and 2.

In principle, a better estimation of theta 2 is not expected, as the number of samples remained the same in the Example.
There is also no the shrinkage effect, because the model is not hierachical.

## Exercise 8.1: three subjets with different sample size

### Read data

Use the same data set given in the Solutions.


```r
# remove some samples from `dat` for the Subject #2
dat <- data.frame(y = c( rep(1,9), rep(0,3), rep(1,45), rep(0,15), rep(1,3),rep(0,9)),
  s = c(rep("A",12), rep("B",60), rep("C",12)))

str(dat)
```

```
'data.frame':	84 obs. of  2 variables:
 $ y: num  1 1 1 1 1 1 1 1 1 0 ...
 $ s: Factor w/ 3 levels "A","B","C": 1 1 1 1 1 1 1 1 1 1 ...
```

```r
table(dat$s)
```

```

 A  B  C 
12 60 12 
```

### MCMC samples


```r
myData <- dat 
out <- genMCMC(data = myData, numSavedSteps = nsteps, saveName = fn)
```


```r
summary(out) 
```

```

Iterations = 501:13000
Thinning interval = 1 
Number of chains = 4 
Sample size per chain = 12500 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

           Mean      SD  Naive SE Time-series SE
theta[1] 0.6877 0.11236 0.0005025      0.0005043
theta[2] 0.7342 0.05493 0.0002456      0.0002479
theta[3] 0.3125 0.11249 0.0005031      0.0005001

2. Quantiles for each variable:

           2.5%    25%    50%    75%  97.5%
theta[1] 0.4506 0.6135 0.6953 0.7701 0.8821
theta[2] 0.6200 0.6985 0.7367 0.7726 0.8348
theta[3] 0.1184 0.2303 0.3042 0.3863 0.5519
```

### Plot diagnostics


```r
l_ply(varnames(out), function(p) {
  diagMCMC(out, p) 
})
```

![](figures-8-1/diagMCMC4-1.png) ![](figures-8-1/diagMCMC4-2.png) ![](figures-8-1/diagMCMC4-3.png) 

### Plot posteriors


```r
plotMCMC(out, data = myData, compVal = NULL , compValDiff = 0.0, ropeDiff = c(-0.05, 0.05)) 
```

![](figures-8-1/post4-1.png) 

### Conclusions

The zero difference between the thetas 1 and 2 is demonstrated because of two factors: 
close values of the estimated thetas;
and the large samples size for the Subject 2.

The contrary conclusion can be done for the non-zero difference for the Subjects 2 and 3.


