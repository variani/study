# Ex. 16
Andrey Ziyatdinov  
`r Sys.Date()`  



## Include 


```r
library(ggplot2)
```

### Include `dbda`


```r
load_all("~/git/variani/dbda/")
```

```

*********************************************************************
Kruschke, J. K. (2015). Doing Bayesian Data Analysis, Second Edition:
A Tutorial with R, JAGS, and Stan. Academic Press / Elsevier.
*********************************************************************
```

### Settings


```r
theme_set(theme_light())
```

## Exercise 16.1

### Data


```r
dat <- read.csv(system.file("data", "ShohatOphirKAMH2012dataReduced.csv", package = "dbda"))
xName <- "Group"
yName <- "PreferenceIndex"
```


```r
ggplot(dat, aes(Group, PreferenceIndex)) + geom_boxplot() 
```

![](figures-16/boxplot-1.png) 


```r
ggplot(dat, aes(Group, GrandTotal)) + geom_boxplot() 
```

![](figures-16/boxplot_2-1.png) 

### Part A


```r
JagsYmetXnom2grpMrobustHet <- function()
{
  out <- list()
  
  oldClass(out) <- "JagsYmetXnom2grpMrobustHet"
  return(out)
}

mod <- JagsYmetXnom2grpMrobustHet()

xName <- "Group"
yName <- "PreferenceIndex"

RopeMuDiff <- c(-0.1, 0.1)
RopeSdDiff <- c(-0.1, 0.1)
RopeEff <- c(-0.1, 0.1)

mcmcCoda <- genMCMC(mod, datFrm = dat, yName = yName, xName = xName,
  numSavedSteps = 50000)
```


```r
pnames <- varnames(mcmcCoda)
for(p in pnames) {
  diagMCMC(mcmcCoda, parName = p)
}
```

![](figures-16/diag-1.png) ![](figures-16/diag-2.png) ![](figures-16/diag-3.png) ![](figures-16/diag-4.png) ![](figures-16/diag-5.png) 


```r
plotMCMC(mod, mcmcCoda , datFrm=dat , yName=yName , xName=xName , 
          RopeMuDiff=RopeMuDiff , RopeSdDiff=RopeSdDiff , RopeEff=RopeEff ,
          pairsPlot=TRUE)
```

![](figures-16/plot-1.png) ![](figures-16/plot-2.png) 

### Part B

### MCMC


```r
JagsYmetXnom2grpMrobustHet <- function()
{
  out <- list()
  
  oldClass(out) <- "JagsYmetXnom2grpMrobustHet"
  return(out)
}

mod <- JagsYmetXnom2grpMrobustHet()

xName <- "Group"
yName <- "GrandTotal"

RopeMuDiff <- c(-0.1, 0.1)
RopeSdDiff <- c(-0.1, 0.1)
RopeEff <- c(-0.1, 0.1)

mcmcCoda2 <- genMCMC(mod, datFrm = dat, yName = yName, xName = xName,
  numSavedSteps = 50000)
```



```r
plotMCMC(mod, mcmcCoda2 , datFrm=dat , yName=yName , xName=xName , 
          RopeMuDiff=RopeMuDiff , RopeSdDiff=RopeSdDiff , RopeEff=RopeEff ,
          pairsPlot=TRUE)
```

![](figures-16/plot2-1.png) ![](figures-16/plot2-2.png) 







